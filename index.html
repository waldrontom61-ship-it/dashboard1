<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YMCA Dashboard</title>
<style>
body {margin:0; font-family:system-ui, -apple-system, sans-serif; background:black; color:white;}
.main-layout {display:flex; height:100vh;}
.content-area {width:70%; position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center;}
.content-media img {position:absolute; width:100%; height:100%; object-fit:cover; opacity:0; transition:opacity 1s;}
.content-media img.active {opacity:1;}
.sidebar-overlay {width:30%; background:#111827; display:flex; flex-direction:column; justify-content:space-between; padding:1rem;}
.section-title {margin:1rem 0 0.5rem; font-weight:bold; border-bottom:1px solid rgba(255,255,255,0.3); text-align:center;}
.info-card {background:rgba(255,255,255,0.1); padding:0.5rem; margin-bottom:0.5rem; border-radius:0.25rem;}
.footer {font-size:0.85rem; display:flex; justify-content:space-between; align-items:center;}
</style>
</head>
<body>
<div class="main-layout">
  <div class="content-area">
    <div class="content-media" id="media-container"></div>
  </div>
  <div class="sidebar-overlay">
    <div>
      <h3 class="section-title">Today's Schedule</h3>
      <div id="today-schedule"></div>
      <h3 class="section-title">Announcements</h3>
      <div id="announcement-container"></div>
    </div>
    <div class="footer">
      <div><span id="currentTime"></span> | <span id="currentDate"></span></div>
      <div><span id="weather-icon">⛅</span> <span id="weather-temp">--°C</span></div>
    </div>
  </div>
</div>

<script>
// JSON data
const dashboardData = {
  "settings": { "gymName": "YMCA of Saskatoon", "rotationSpeed": 4 },
  "media": [
    { "type": "image", "src": "https://ymcasaskatoon.org/wp-content/uploads/2025/09/20250610-YMCA-STILLS_10339-scaled.jpg" },
    { "type": "image", "src": "https://ymcasaskatoon.org/wp-content/uploads/2025/08/YMCA-3July25_-69-scaled.jpg" },
    { "type": "image", "src": "https://ymcasaskatoon.org/wp-content/uploads/2025/10/Pixyl-Test.png" }
  ],
  "weekly_schedule": {
    "Monday":[{"time":"9:00 AM - 9:45 AM","event":"NEW CLASS OCT 20Y-Cycle"},{"time":"9:00 AM - 9:45 AM","event":"Aquafit"},{"time":"10:00 AM - 10:45 AM","event":"NEW CLASS OCT 20 Tabata Blast"},{"time":"12:10 PM - 12:50 PM","event":"Y-Fit Circuit"},{"time":"6:15 PM - 7:30 PM","event":"Beginner Yoga"}],
    "Tuesday":[{"time":"8:00 AM - 8:45 AM","event":"Active Aging with Fred Dyck"},{"time":"9:00 AM - 9:45 AM","event":"Aquafit"},{"time":"12:10 PM - 12:50 PM","event":"Step"},{"time":"1:30 PM - 2:15 PM","event":"Aquafit"}],
    "Wednesday":[{"time":"9:00 AM - 9:45 AM","event":"Aquafit"},{"time":"12:10 PM - 12:50 PM","event":"Y-Fit Full Body with Kris Seto Davis"}],
    "Thursday":[{"time":"6:15 AM - 7:00 AM","event":"Strength, Sweat & Stretch"},{"time":"8:00 AM - 8:45 AM","event":"Active Aging with Fred Dyck"},{"time":"9:00 AM - 9:45 AM","event":"Aquafit"},{"time":"12:10 PM - 12:50 PM","event":"Bootcamp"},{"time":"1:30 PM - 2:15 PM","event":"Aquafit"},{"time":"7:00 PM - 7:45 PM","event":"OCT 16 Aquastep"}],
    "Friday":[{"time":"9:00 AM - 9:45 AM","event":"NEW CLASS OCT 24 Core & More"},{"time":"9:00 AM - 9:45 AM","event":"Aquafit"},{"time":"10:00 AM - 10:45 AM","event":"NEW CLASS OCT 20 Tabata Blast"},{"time":"12:10 PM - 12:50 PM","event":"Spin"},{"time":"12:00 PM - 1:30 PM","event":"Pickleball"}],
    "Saturday":[{"time":"8:00 AM - 8:45 AM","event":"NEW CLASS OCT 25 Y-Cycle"},{"time":"10:00 AM - 11:00 AM","event":"Energizing Yoga"},{"time":"1:30 PM - 2:15 PM","event":"Aquafit"}],
    "Sunday":[{"time":"","event":"NO CLASS"}]
  },
  "classes": [], "announcements": []
};

// Render media slideshow
let currentMedia = 0;
function renderMedia() {
  const container = document.getElementById('media-container');
  container.innerHTML = '';
  dashboardData.media.forEach((item, i)=>{
    const img = document.createElement('img');
    img.src = item.src;
    if(i===0) img.classList.add('active');
    container.appendChild(img);
  });
  setInterval(()=>{
    const images = document.querySelectorAll('#media-container img');
    images[currentMedia].classList.remove('active');
    currentMedia = (currentMedia+1)%images.length;
    images[currentMedia].classList.add('active');
  }, 5000);
}

// Render today's schedule
function renderSchedule() {
  const today = new Date().toLocaleDateString('en-US',{weekday:'long'});
  const events = dashboardData.weekly_schedule[today] || [];
  const container = document.getElementById('today-schedule');
  container.innerHTML = '';
  if(events.length===0) { container.innerHTML='<div class="info-card">No classes today</div>'; return;}
  events.forEach(ev=>{
    const div = document.createElement('div');
    div.className='info-card';
    div.textContent = `${ev.time} • ${ev.event}`;
    container.appendChild(div);
  });
}

// Weather
async function updateWeather(){
  try{
    const r = await fetch('https://api.open-meteo.com/v1/forecast?latitude=52.1332&longitude=-106.6700&current_weather=true');
    const d = await r.json();
    if(d.current_weather){
      const t=Math.round(d.current_weather.temperature);
      document.getElementById('weather-temp').textContent=`${t}°C`;
      document.getElementById('weather-icon').textContent='⛅'; // optional: map codes
    }
  } catch(e){console.log('Weather failed');}
}

// Date/time
function updateDateTime(){
  const now=new Date();
  document.getElementById('currentTime').textContent=now.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true});
  document.getElementById('currentDate').textContent=now.toLocaleDateString('en-US',{weekday:'long',month:'short',day:'numeric'});
}

// Init
document.addEventListener('DOMContentLoaded',()=>{
  renderMedia();
  renderSchedule();
  updateDateTime();
  setInterval(updateDateTime,1000);
  updateWeather();
  setInterval(updateWeather,300000);
});
</script>
</body>
</html>
